<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>title</title>
    <link rel="stylesheet" href="dist/sortable-0.8.0/css/sortable-theme-bootstrap.css" />
    <link rel="stylesheet" href="dist/sortable-0.8.0/css/sortable-theme-finder.css" />
    <script src="dist/sortable-0.8.0/js/sortable.min.js"></script>
</head>

<body>
    <h1 style="font-family: Arial, Helvetica, sans-serif;">Argo Sotware Guidelines</h1>
    <input type="text" id="myInput" onkeyup="mySearchFunction()" placeholder="Search ..." title="Type in a keyword">
    <br><br>
    <table id="thistable" class="sortable-theme-finder" data-sortable>
        <thead>
            <tr>
                <th><b>ID</b></th>
                <th><b>Title</b></th>
                <th><b>Skill Level</b></th>
                <th><b>Label #1</b></th>
                <th><b>Label #2</b></th>
                <th><b>Label #1 priority</b></th>
                <th><b>FAIR4RS</b></th>
                <th><b>Argo FAIR tools</b></th>
            </tr>
        </thead>
        <tbody id="data-output">
            <!-- Prodcuts from javascript file in here. -->
        </tbody>
    </table>
    <br>
    <script>        
        fetch("guidelines_v1.json")
            .then(function (response) {
                return response.json();
            })
            .then(function (products) {
                let placeholder = document.querySelector("#data-output");
                let out = "";
                let id = 1;
                for (let product of products.data.node.items.nodes) {                    
                    out += '<tr>';
                    out += `<td><b>${id}</b></td>`;
                    id++;    
                    out += `<td>${product.content.title}</td>`;
                    // Skill Level
                    let skillLevel = "";
                    for (let i = 1; i < product.fieldValues.nodes.length; i++) {
                        let elem = product.fieldValues.nodes[i];                        
                        if (elem.field.name === "Skill level") {
                            skillLevel = `<td>${elem.name}</td>`;
                            break;
                        }
                        else {
                            skillLevel = `<td> </td>`;
                        }
                    };
                    out += skillLevel;
                    // Label #1
                    let label1 = "";
                    for (let i = 1; i < product.fieldValues.nodes.length; i++) {
                        let elem = product.fieldValues.nodes[i];
                        if (elem.field.name === "Label #1") {
                            label1 = `<td>${elem.name}</td>`;
                            break;
                        }
                        else {
                            label1 = `<td> </td>`;
                        }
                    };
                    out += label1;
                    // Label #2
                    let label2 = "";
                    for (let i = 1; i < product.fieldValues.nodes.length; i++) {
                        let elem = product.fieldValues.nodes[i];
                        if (elem.field.name === "Label #2") {
                            label2 = `<td>${elem.name}</td>`;
                            break;
                        }
                        else {
                            label2 = `<td> </td>`;
                        }
                    };
                    out += label2;
                    // Label #1 priority
                    let label1Priority = "";
                    for (let i = 1; i < product.fieldValues.nodes.length; i++) {
                        let elem = product.fieldValues.nodes[i];
                        if (elem.field.name === "Label #1 priority") {
                            label1Priority = `<td>${elem.name}</td>`;
                            break;
                        }
                        else {
                            label1Priority = `<td> </td>`;
                        }
                    };
                    out += label1Priority;
                    // FAIR4RS
                    let fair4rs = "";
                    for (let i = 1; i < product.fieldValues.nodes.length; i++) {
                        let elem = product.fieldValues.nodes[i];
                        if (elem.field.name === "FAIR4RS") {
                            fair4rs = `<td>${elem.name}</td>`;
                            break;
                        }
                        else {
                            fair4rs = `<td> </td>`;
                        }
                    };
                    out += fair4rs;
                    // Argo FAIR tools
                    let argoFairTools = "";
                    for (let i = 1; i < product.fieldValues.nodes.length; i++) {
                        let elem = product.fieldValues.nodes[i];
                        if (elem.field.name === "Argo FAIR tools") {
                            argoFairTools = `<td>${elem.name}</td>`;
                            break;
                        }
                        else {
                            argoFairTools = `<td> </td>`;
                        }
                    };
                    out += argoFairTools;

                    out += '</tr>';
                }

                placeholder.innerHTML = out;
            });

        function mySearchFunction() {
            var input, filter, table, tr, td, i;
            input = document.getElementById("myInput");
            filter = input.value.toUpperCase();
            table = document.getElementById("thistable");
            tr = table.getElementsByTagName("tr");
            console.log(input,filter,tr);
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[1]; // Search in the second column (Title)
                if (td) {
                    if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }    
    </script>
</body>

</html>